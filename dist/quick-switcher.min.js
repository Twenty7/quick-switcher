/*! quick-switcher 2017-01-08 */
!function(a,b){var c={filters:{isFuzzyMatch:function(a,b){for(var c=0,d=0;c<a.length&&d<b.length;c++)for(;d<b.length&&(d++,a.charAt(c)!==b.charAt(d)););return d<b.length},areWordsFound:function(a,b){for(var c=a.split(/[^\w]/),d=0;d<c.length;d++)if(b.indexOf(c[d])===-1)return!1;return!0},isMatch:function(a,b){return b.indexOf(a)!==-1||!!this.areWordsFound(a,b)}}},d={init:function(a,c,d,e){this.$parentDom=null,this.$liCollection=null,this.valueObjects=null,this.selectedIndex=null,this.$results=null,this.$noSearchTerms=null,this.$noResults=null,this.$loading=null,this.$breadcrumb=null,this.$search=null,this.searchText="",this.searchDelayTimeout=null,this.searchId=0,this.options=b.extend({searchDelay:1e3},e),this.initDomElement(a),this.searchCallback=c,this.abortSearchCallback=null,this.searchDelay=this.options.searchDelay,this.selectCallback=d,this.callbackStack=[]},initDomElement:function(a){var c=this;this.$parentDom=a,this.$domElement=b('<div class="lstr-qswitcher-overlay"></div><div class="lstr-qswitcher-container">  <form class="lstr-qswitcher-popup">    <div class="lstr-qswitcher-breadcrumb">    </div>    <div class="lstr-qswitcher-help">      <ul>        <li><em>&#8597;</em> to navigate</li>        <li><em>&#8629;</em> to select</li>        <li><em>&#9003;</em> to clear</li>        <li><em>esc</em> to dismiss</li>      </ul>    </div>    <input type="text" class="lstr-qswitcher-search form-control" />    <div class="lstr-qswitcher-loading">Loading...</div>    <div class="lstr-qswitcher-no-terms"></div>    <div class="lstr-qswitcher-no-results">No results found</div>    <div class="lstr-qswitcher-oops-results">Oops! Something went wrong while trying to load your results.</div>    <div class="lstr-qswitcher-results"></div>  </form></div>'),a.append(this.$domElement),this.$breadcrumb=this.$domElement.find(".lstr-qswitcher-breadcrumb"),this.$search=this.$domElement.find(".lstr-qswitcher-search"),this.$loading=this.$domElement.find(".lstr-qswitcher-loading"),this.$results=this.$domElement.find(".lstr-qswitcher-results"),this.$noSearchTerms=this.$domElement.find(".lstr-qswitcher-no-terms"),this.$noResults=this.$domElement.find(".lstr-qswitcher-no-results"),this.$oopsResults=this.$domElement.find(".lstr-qswitcher-oops-results"),this.$domElement.find(".lstr-qswitcher-popup").on("submit",function(a){a.preventDefault()}),this.$parentDom.find(".lstr-qswitcher-overlay").on("click",function(a){c.closeSwitcher(),a.preventDefault()}),this.$parentDom.on("keydown",function(a){(a.metaKey||a.ctrlKey)&&75===a.which&&(c.toggleSwitcher(),a.preventDefault())}),b("html").on("keydown",".lstr-qswitcher-noscroll",function(a){if(38===a.which)c.selectIndex(c.selectedIndex-1),c.scrollToSelectedItem(),a.preventDefault();else if(40===a.which)c.selectIndex(c.selectedIndex+1),c.scrollToSelectedItem(),a.preventDefault();else if(27===a.which)c.toggleSwitcher(),a.preventDefault();else if(13===a.keyCode){b(this);c.triggerSelect(c.selectedIndex,a),a.preventDefault()}}),this.$search.on("keyup",function(a){var b=c.$search.val();c.searchDelayTimeout&&(clearTimeout(c.searchDelayTimeout),c.searchDelayTimeout=null),b!==c.searchText?c.searchDelayTimeout=setTimeout(function(){c.selectIndex(null),c.searchText=b,c.renderList()},c.searchDelay):8===a.which&&""===b&&(c.popCallback(),c.renderList())}),this.$domElement.on("hover",".lstr-qswitcher-results li",function(){var a=b(this);c.selectIndex(a.data("lstr-qswitcher").index)}),this.$domElement.on("click",".lstr-qswitcher-results li",function(a){var d=b(this);c.triggerSelect(d.data("lstr-qswitcher").index,a)})},renderList:function(){this.abortSearchCallback&&(this.abortSearchCallback(),this.abortSearchCallback=null),this.renderBreadcrumb(),this.usePane(this.$loading);var a=Object.create(c);++this.searchId,a.setResults=this.setResults.bind(this,this.searchId),a.setError=this.setError.bind(this,this.searchId),this.abortSearchCallback=this.searchCallback(this.searchText,a)},setResults:function(a,c){if(a===this.searchId){var d=this;if(d.valueObjects=[],0==c.length)return this.$results.html(""),void this.usePane(this.searchText?this.$noResults:this.$noSearchTerms);var e=b("<ul>");c.forEach(function(a,c){var f=b("<li>"),g=b("<div>");if(e.append(f),f.append(g),d.setListText(g,a),a.description){var h=b('<span class="lstr-qswitcher-results-description"></span>');d.setListText(h,a.description),f.prepend(h)}f.data("lstr-qswitcher",{index:c}),g.addClass("lstr-qswitcher-result-container"),a.searchCallback&&f.addClass("lstr-qswitcher-result-category"),d.valueObjects[c]={index:c,value:a,$li:f}}),this.$results.html(e),this.usePane(this.$results),d.selectIndex(0)}},setError:function(a){a===this.searchId&&this.usePane(this.$oopsResults)},renderBreadcrumb:function(){var a=b("<ul>");this.callbackStack.forEach(function(c,d){var e=b("<li>");e.text(c.text),a.append(e)}),this.$breadcrumb.html(a)},setListText:function(a,b){return b.toHtml||b.html?void a.html(b.toHtml?b.toHtml():b.html):b.toText||b.text?void a.text(b.toText?b.toText():b.text):void a.text(b)},selectIndex:function(a){return null!==this.selectedIndex&&this.valueObjects[this.selectedIndex]&&this.valueObjects[this.selectedIndex].$li.removeClass("lstr-qswitcher-result-selected"),null===a?void(this.selectedIndex=null):(this.selectedIndex=a%this.valueObjects.length,this.selectedIndex<0&&(this.selectedIndex=this.valueObjects.length-1),void this.valueObjects[this.selectedIndex].$li.addClass("lstr-qswitcher-result-selected"))},scrollToSelectedItem:function(){var a=this.valueObjects[this.selectedIndex].$li,b=this.$results,c=a.offset().top-a.parent().offset().top,d=c+a.outerHeight(!0),e=b.scrollTop(),f=e+b.outerHeight(!0);(d>f||c<e)&&b.scrollTop(c)},toggleSwitcher:function(){this.useRootCallback(),this.$search.val(""),this.renderList(),this.$parentDom.toggleClass("lstr-qswitcher-noscroll"),this.$search.focus()},closeSwitcher:function(){this.$parentDom.removeClass("lstr-qswitcher-noscroll")},triggerSelect:function(a,b){if(null!==a){var c=this.valueObjects[a].value;return c.searchCallback?(this.callbackStack.push({text:c.breadcrumbText,parentSearchCallback:this.searchCallback,parentSearchDelay:this.parentSearchDelay,parentSelectCallback:this.selectCallback}),this.searchCallback=c.searchCallback,c.searchDelay&&(this.searchDelay=c.searchDelay),c.selectCallback&&(this.selectCallback=c.selectCallback),this.valueObjects=[],this.selectIndex(null),this.$search.val(""),void this.renderList()):void(!1!==this.selectCallback(c,b)&&this.closeSwitcher())}},popCallback:function(){var a=this.callbackStack.pop();return!!a&&(this.searchCallback=a.parentSearchCallback,this.searchDelay=a.parentSearchDelay,this.selectCallback=a.parentSelectCallback,!0)},useRootCallback:function(){for(;this.callbackStack.length>0;)this.popCallback()},usePane:function(a){this.$results.hide(),this.$noSearchTerms.hide(),this.$noResults.hide(),this.$oopsResults.hide(),this.$loading.hide(),a.show()}};a.lstrQuickSwitcher=function(a,c,e){var f=b("body"),g=Object.create(d);g.init(f,a,c,e)}}(window,jQuery);